/*! service-center - v0.0.1 -  auth:alian*/
!function(a){"use strict";a.slider=function(b,c){var d={setting:{imgAry:[],hasDot:!0,isLoop:!1,indexNow:0,isFullScreen:!0,$el:null,autoSlide:!1},$el:null,$close:null,$ul:null,$li:null,$nav:null,$navli:null,$imgs:null,liLength:0,liWidth:0,ulWidth:0,indexNow:0,winWidth:0,winHeight:0,loadNum:0,initFingerDis:0,isScale:!1,isSliding:!1,initImgMoveX:0,initImgMoveY:0,lastImgMoveX:0,lastImgMoveY:0,lastSlideX:0,initSlideX:0,minScale:1.3,maxScale:3,scaleArg:1,finalScale:1,moveX:0,moveY:0,scale:1,init:function(b,c){this.$el=this.setting.$el||null,this.winWidth=a(window).width(),this.winHeight=a(window).height(),this.setting.indexNow>0&&(this.indexNow=this.setting.indexNow-1),this.liLength=this.setting.imgAry.length||this.$el.find("li").length,this.liWidth=this.setting.isFullScreen?this.winWidth:this.$el.width(),this.ulWidth=this.setting.isLoop?this.liWidth*(this.liLength+2):this.liWidth*this.liLength,this.render(),this.onEvent(),this.autoSlide()},render:function(){this.setting.isFullScreen?this.fullScreenRender():this.notfullScreenRender()},onEvent:function(){var a=this;this.$el.on("touchstart doubleTap",function(b){a.onTouchEvent.call(a,b)})},fullScreenRender:function(){var b=a(window).scrollTop(),c='<div class="slide-wrapper" id="J-slide-wrapper"><ul class="slide"></ul><span class="slide-close" id="J-slide-colse">关闭</span></div>';this.$el=a(c),this.$close=this.$el.find("#J-slide-colse"),this.$ul=this.$el.find("ul"),a("body").append(this.$el),this.appendImg(),this.appendDot(),this.$el.css({width:this.winWidth,height:this.winHeight,top:b}).show(),this.$ul.css({width:this.ulWidth+"px"}),this.locUl(),this.$li=this.$ul.find("li"),this.$li.css({width:this.liWidth+"px"})},notfullScreenRender:function(){this.$ul=this.$el.find("ul"),this.$li=this.$el.find("li"),this.$ul.css({width:this.ulWidth+"px"}),this.$li.css({width:this.liWidth+"px"}),this.$el.addClass("slide-wrapper_n"),this.setting.isLoop&&(this.$li.eq(0).before(this.$li.eq(this.liLength-1).clone()),this.$ul.append(this.$li.eq(0).clone())),this.appendDot(),this.locUl()},imgOnload:function(b){this.loadNum++,this.initImg(a(b.target)),this.loadNum==this.liLength&&c&&c()},autoSlide:function(){var a=this;(this.setting.autoSlide||!this.setting.isFullScreen)&&(this.timer=setInterval(function(){a.setting.isLoop||a.indexNow!=a.liLength-1||(a.indexNow=-1),a.movenext()},3e3))},locUl:function(){this.setting.isLoop&&this.$ul.css("left",-this.liWidth+"px"),this.transform(0,-this.indexNow*this.liWidth,0,1,"auto",this.$ul)},appendDot:function(){if(this.setting.hasDot){this.$el.append('<ul class="slide-nav"></ul>'),this.$nav=this.$el.find(".slide-nav");for(var a=0;a<this.liLength;a++)this.$nav.append("<li></li>");this.$navli=this.$nav.find("li"),this.$navli.eq(this.indexNow).addClass("on")}},appendImg:function(){for(var a="",b=this,c=0;c<this.liLength;c++)0==c&&this.setting.isLoop&&(a+='<li class="Route"><span class="slide-tips">加载中...</span><img src="'+this.setting.imgAry[this.liLength-1]+'" /></li>'),a+='<li class="Route"><span class="slide-tips">加载中...</span><img src="'+this.setting.imgAry[c]+'" /></li>',c==this.liLength-1&&this.setting.isLoop&&(a+='<li class="Route"><span class="slide-tips">加载中...</span><img src="'+this.setting.imgAry[0]+'" /></li>');this.$ul.append(a),this.$imgs=this.$ul.find("img"),this.$imgs.on("load error emptied stalled",function(a){b.imgOnload.call(b,a)})},initImg:function(a){var b=a[0].naturalHeight,c=a[0].naturalWidth;if(c&&b){if(b>c){var d=this.winHeight/b,e=this.winWidth/c;e*b>this.winHeight?a.css({width:c*d,height:this.winHeight}):a.css({width:this.winWidth,height:b*e})}a.prev().remove(),a.show()}else a.html('<span class="slide-tips">加载失败</span>')},onTouchEvent:function(b){var c=this,d=b.type,e=b.touches||[],f=this.setting.isLoop?this.$li.eq(this.indexNow+1):this.$li.eq(this.indexNow);if(b.preventDefault&&b.preventDefault(),"J-slide-colse"===a(b.target).attr("id"))return void this.destory();switch(d){case"touchstart":console.log("touchstart"),this.isFullScreen||clearInterval(this.timer),2===e.length?(this.initFingerDis=this.fingersDistance(e),this.isScale=!0):1===e.length&&this.isScale&&!this.isSliding?(this.initImgMoveX=e[0].clientX-this.moveX,this.initImgMoveY=e[0].clientY-this.moveY):1!==e.length||this.isScale||(this.initSlideX=this.lastSlideX=e[0].clientX,this.moveLength=0),this.$el.on("touchmove touchend",function(a){c.onTouchEvent.call(c,a)});break;case"touchmove":if(console.log("touchmove"),2!==e.length||this.isSliding)1===e.length&&this.isScale&&!this.isSliding?(this.lastImgMoveX=e[0].clientX,this.lastImgMoveY=e[0].clientY,this.moveX=this.lastImgMoveX-this.initImgMoveX,this.moveY=this.lastImgMoveY-this.initImgMoveY,this.transform(0,this.moveX,this.moveY,this.finalScale,"50% 50%",f)):1===e.length&&(this.isSliding=!0,this.lastSlideX=e[0].clientX,this.moveLength=this.lastSlideX-this.initSlideX,this.transform(0,-c.indexNow*c.liWidth+c.moveLength,0,1,"auto",this.$ul));else{this.lastFingerDis=this.fingersDistance(e);var g=this.lastFingerDis/this.initFingerDis;this.scale=g*this.finalScale,this.transform(0,0,0,this.scale,"50% 50%",f)}break;case"touchend":console.log("touchend"),this.$el.off("touchmove touchend"),this.resetSliderPosition(),this.resetImgPosition(f),this.isFullScreen||this.autoSlide(),f=null;break;case"doubleTap":this.isScale&&(this.finalScale=1,this.moveY=0,this.moveX=0,this.transform(3,0,0,1,"50% 50%",f),this.isScale=!1),f=null}},resetSliderPosition:function(){if(this.isSliding){var a=this.moveLength,b=0!=this.indexNow||this.setting.isLoop,c=this.indexNow!=this.liLength-1||this.setting.isLoop;0>a&&Math.abs(a)>this.liWidth/3&&c?(console.log("moveToLeft"),this.movenext()):a>0&&Math.abs(a)>this.liWidth/3&&b?(console.log("moveToRight"),this.moveprev()):this.transform(3,-this.indexNow*this.liWidth,0,1,"auto",this.$ul),this.isSliding=!1}},resetImgPosition:function(a){if(this.isScale){var b=a.find("img");this.scale<=this.minScale?(this.finalScale=1,this.moveY=0,this.moveX=0,this.transform(3,0,0,1,"50% 50%",a),this.isScale=!1):this.finalScale=this.scale;var c=b.width(),d=b.height(),e=(this.winHeight-d)/2;e>0?this.moveY<-e?this.moveY=-e:this.moveY>e&&(this.moveY=e):this.moveY<e?this.moveY=e:this.moveY>-e&&(this.moveY=-e),e=(this.winWidth-c)/2,e>0?this.moveX<-e?this.moveX=-e:this.moveX>e&&(this.moveX=e):this.moveX<e?this.moveX=e:this.moveX>-e&&(this.moveX=-e),this.transform(3,this.moveX,this.moveY,this.finalScale,"50% 50%",a)}},slide:function(){var a=this;this.movenext(),this.timer=setTimeout(function(){a.slide.call(a)},2e3)},moveprev:function(){var a=this;this.indexNow--,this.transform(3,-this.indexNow*this.liWidth,0,1,"auto",this.$ul),this.indexNow<0&&this.setting.isLoop&&(this.indexNow=this.liLength-1,setTimeout(function(){a.transform(0,-a.indexNow*a.liWidth,0,1,"auto",a.$ul)},200)),this.setting.hasDot&&(this.$navli.removeClass("on"),this.$navli.eq(this.indexNow).addClass("on"))},movenext:function(){var a=this;this.indexNow++,this.transform(3,-this.indexNow*this.liWidth,0,1,"auto",this.$ul),this.indexNow>=this.liLength&&this.setting.isLoop&&(this.indexNow=0,setTimeout(function(){a.transform(0,0,0,1,"auto",a.$ul)},200)),this.setting.hasDot&&(this.$navli.removeClass("on"),this.$navli.eq(this.indexNow).addClass("on"))},transform:function(a,b,c,d,e,f){f.css({transform:"translate3d("+b+"px, "+c+"px, 0px) scale("+d+")","-webkit-transform":"translate3d("+b+"px, "+c+"px, 0px) scale("+d+")",transition:"all 0."+a+"s cubic-bezier(0.22, 0.69, 0.72, 0.88)","-webkit-transition":"all 0."+a+"s cubic-bezier(0.22, 0.69, 0.72, 0.88)","transform-origin":e,"-webkit-transform-origin":e})},fingersDistance:function(a){var b=a[0]||{},c=a[1]||{},d=b.clientX||0,e=c.clientX||0,f=b.clientY||0,g=c.clientY||0,h=Math.abs(d-e),i=Math.abs(f-g);return Math.sqrt(h*h+i*i)},destory:function(a){this.$close&&(this.$close.off("touchstar"),this.$close=null),this.$imgs&&(this.$imgs.off("load error emptied stalled"),this.$imgs=null),this.$el&&(this.$el.off("touchstar touchmove touchend").remove(),this.$el=null)}};return a.extend(d.setting,b||{}),d.init(),this}}(window.Zepto),function(a){a.slider=function(b,c){var d={setting:{imgAry:[],hasDot:!0,isLoop:!1,indexNow:0},init:function(b,c){this.$el=null,this.$close=null,this.$ul=null,this.$li=null,this.$nav=null,this.$navli=null,this.$imgs=null,this.liLength=this.setting.imgAry.length,this.liWidth=0,this.ulWidth=0,this.indexNow=this.setting.indexNow||0,this.winWidth=a(window).width(),this.winHeight=a(window).height(),this.loadNum=0,this.initFingerDis=0,this.isScale=!1,this.isMove=!1,this.initImgMoveX=0,this.initImgMoveY=0,this.lastImgMoveX=0,this.lastImgMoveY=0,this.lastSlideX=0,this.initSlideX=0,this.minScale=1.3,this.maxScale=3,this.scaleArg=1,this.finalScale=1,this.moveX=0,this.moveY=0,this.scale=1,this.render(),this.onEvent()},onload:function(b){this.loadNum++,this.initImg(a(b.target)),this.loadNum==this.liLength&&c&&c()},render:function(){var b='<div class="slide-wrapper" id="J-slide-wrapper"><ul class="slide"></ul><ul class="slide-nav"></ul><span class="slide-close" id="J-slide-colse">关闭</span></div>';if(this.$el=a(b),this.$close=this.$el.find("#J-slide-colse"),this.$ul=this.$el.find(".slide"),this.$nav=this.$el.find(".slide-nav"),this.liWidth=this.winWidth,this.ulWidth=this.setting.isLoop?this.liWidth*(this.liLength+2):this.liWidth*this.liLength,a("body").append(this.$el),this.appendImg(),this.setting.hasDot){for(var c=0;c<this.liLength;c++)this.$nav.append("<li></li>");this.$navli=this.$el.find(".slide-nav li"),this.$navli.eq(0).addClass("on")}var d=a("body").scrollTop();this.$el.css({width:this.winWidth,height:this.winHeight,top:d}).show(),this.$ul.css({width:this.ulWidth+"px"}),this.setting.isLoop&&this.$ul.css("left",-this.liWidth+"px"),this.transform(0,-this.indexNow*this.liWidth,0,1,"auto",this.$ul),this.setting.hasDot&&(this.$navli.removeClass("on"),this.$navli.eq(this.indexNow).addClass("on")),this.$li=this.$el.find(".slide li"),this.$li.css({width:this.liWidth+"px"})},appendImg:function(){for(var a="",b=this,c=0;c<this.liLength;c++)0==c&&this.setting.isLoop&&(a+='<li class="Route"><span class="slide-tips">加载中...</span><img src="'+this.setting.imgAry[this.liLength-1]+'" /></li>'),a+='<li class="Route"><span class="slide-tips">加载中...</span><img src="'+this.setting.imgAry[c]+'" /></li>',c==this.liLength-1&&this.setting.isLoop&&(a+='<li class="Route"><span class="slide-tips">加载中...</span><img src="'+this.setting.imgAry[0]+'" /></li>');this.$ul.append(a),this.$imgs=this.$ul.find("img"),this.$imgs.on("load error emptied stalled",function(a){b.onload.call(b,a)})},initImg:function(a){var b=a[0].naturalHeight,c=a[0].naturalWidth;if(c&&b){if(b>c){var d=this.winHeight/b,e=this.winWidth/c;e*b>this.winHeight?a.css({width:c*d,height:this.winHeight}):a.css({width:this.winWidth,height:b*e})}a.prev().remove(),a.show()}else a.html('<span class="slide-tips">加载失败</span>')},onEvent:function(){var a=this;this.$el.on("touchstart doubleTap",function(b){a.onTouchEvent.call(a,b)})},onTouchEvent:function(b){var c=this,d=b.type,e=b.touches||[],f=this.setting.isLoop?this.$li.eq(this.indexNow+1):this.$li.eq(this.indexNow);if(b.preventDefault&&b.preventDefault(),"J-slide-colse"===a(b.target).attr("id"))return void this.destory();switch(d){case"touchstart":2===e.length?(this.initFingerDis=this.fingersDistance(e),this.isScale=!0):1===e.length&&this.isScale&&!this.isMove?(this.initImgMoveX=e[0].clientX-this.moveX,this.initImgMoveY=e[0].clientY-this.moveY):1!==e.length||this.isScale||(this.initSlideX=this.lastSlideX=e[0].clientX,this.moveLength=0),this.$el.on("touchmove touchend",function(a){c.onTouchEvent.call(c,a)});break;case"touchmove":if(2!==e.length||this.isMove)1===e.length&&this.isScale&&!this.isMove?(this.lastImgMoveX=e[0].clientX,this.lastImgMoveY=e[0].clientY,this.moveX=this.lastImgMoveX-this.initImgMoveX,this.moveY=this.lastImgMoveY-this.initImgMoveY,this.transform(0,this.moveX,this.moveY,this.finalScale,"50% 50%",f)):1===e.length&&(this.isMove=!0,this.lastSlideX=e[0].clientX,this.moveLength=this.lastSlideX-this.initSlideX,this.transform(0,-c.indexNow*c.liWidth+c.moveLength,0,1,"auto",this.$ul));else{this.lastFingerDis=this.fingersDistance(e);var g=this.lastFingerDis/this.initFingerDis;this.scale=g*this.finalScale,this.transform(0,0,0,this.scale,"50% 50%",f)}break;case"touchend":this.$el.off("touchmove touchend"),this.resetSliderPosition(),this.resetImgPosition(f),this.$el.off("touchmove touchend");break;case"doubleTap":this.isScale&&(this.finalScale=1,this.moveY=0,this.moveX=0,this.transform(3,0,0,1,"50% 50%",f),this.isScale=!1)}},resetSliderPosition:function(){if(this.isMove){var a=this.moveLength,b=0!=this.indexNow||this.setting.isLoop,c=this.indexNow!=this.liLength-1||this.setting.isLoop;0>a&&Math.abs(a)>this.liWidth/3&&c?this.movenext():a>0&&Math.abs(a)>this.liWidth/3&&b?this.moveprev():this.transform(3,-this.indexNow*this.liWidth,0,1,"auto",this.$ul),this.isMove=!1}},resetImgPosition:function(a){if(this.isScale){var b=a.find("img");this.scale<=this.minScale?(this.finalScale=1,this.moveY=0,this.moveX=0,this.transform(3,0,0,1,"50% 50%",a),this.isScale=!1):this.finalScale=this.scale;var c=b.width(),d=b.height(),e=(this.winHeight-d)/2;e>0?this.moveY<-e?this.moveY=-e:this.moveY>e&&(this.moveY=e):this.moveY<e?this.moveY=e:this.moveY>-e&&(this.moveY=-e),e=(this.winWidth-c)/2,e>0?this.moveX<-e?this.moveX=-e:this.moveX>e&&(this.moveX=e):this.moveX<e?this.moveX=e:this.moveX>-e&&(this.moveX=-e),this.transform(3,this.moveX,this.moveY,this.finalScale,"50% 50%",a)}},slide:function(){var a=this;this.movenext(),this.timer=setTimeout(function(){a.slide.call(a)},2e3)},moveprev:function(){var a=this;this.indexNow--,this.transform(2,-this.indexNow*this.liWidth,0,1,"auto",this.$ul),this.indexNow<0&&this.setting.isLoop&&(this.indexNow=this.liLength-1,setTimeout(function(){a.transform(0,-a.indexNow*a.liWidth,0,1,"auto",a.$ul)},200)),this.setting.hasDot&&(this.$navli.removeClass("on"),this.$navli.eq(this.indexNow).addClass("on"))},movenext:function(){var a=this;this.indexNow++,this.transform.call(this,2,-this.indexNow*this.liWidth,0,1,"auto",this.$ul),this.indexNow>=this.liLength&&this.setting.isLoop&&(this.indexNow=0,setTimeout(function(){a.transform(0,0,0,1,"auto",a.$ul)},200)),this.setting.hasDot&&(this.$navli.removeClass("on"),this.$navli.eq(this.indexNow).addClass("on"))},transform:function(a,b,c,d,e,f){f.css({transform:"translate3d("+b+"px, "+c+"px, 0px) scale("+d+")","-webkit-transform":"translate3d("+b+"px, "+c+"px, 0px) scale("+d+")",transition:"all 0."+a+"s cubic-bezier(0.22, 0.69, 0.72, 0.88)","-webkit-transition":"all 0."+a+"s cubic-bezier(0.22, 0.69, 0.72, 0.88)","transform-origin":e,"-webkit-transform-origin":e})},fingersDistance:function(a){var b=a[0]||{},c=a[1]||{},d=b.clientX||0,e=c.clientX||0,f=b.clientY||0,g=c.clientY||0,h=Math.abs(d-e),i=Math.abs(f-g);return Math.sqrt(h*h+i*i)},destory:function(a){this.$close&&(this.$close.off("touchstar"),this.$close=null),this.$imgs&&(this.$imgs.off("load error emptied stalled"),this.$imgs=null),this.$el&&(this.$el.off("touchstar touchmove touchend").remove(),this.$el=null)},handleData:function(a){this.setting.imgAry=a()}};return a.extend(d.setting,b||{}),d.init(),this}}(window.Zepto);